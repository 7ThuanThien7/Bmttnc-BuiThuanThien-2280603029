<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Caesar Cipher</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            margin-top: 20px;
            background-color: #f8f9fa; /* Light gray background */
            color: #333;
        }
        .container {
            max-width: 700px; /* Adjusted max-width for a cleaner look */
            background-color: #ffffff;
            padding: 30px;
            border-radius: 12px; /* Slightly more rounded corners */
            box-shadow: 0 6px 12px rgba(0,0,0,0.1); /* Softer shadow */
        }
        .page-title {
            color: #343a40; /* Darker title color */
            margin-bottom: 1.8rem; /* Increased bottom margin */
        }
        .card {
            margin-bottom: 25px;
            border: none; /* Remove default card border */
            box-shadow: 0 4px 8px rgba(0,0,0,0.07); /* Subtle shadow for cards */
            border-radius: 8px; /* Rounded corners for cards */
            overflow: hidden; /* Ensures child elements respect border radius */
        }
        .card-header {
            font-weight: 600; /* Semibold */
            padding: 1rem 1.25rem; /* Adjusted padding */
            font-size: 1.15rem; /* Slightly larger header font */
            border-bottom: 1px solid rgba(0,0,0,0.05); /* Subtle border */
        }
        /* Custom color for Encryption Card */
        .card-header.bg-encrypt-custom {
            background-color: #c80a10; /* Rebeccapurple */
            color: white;
        }
        .btn-encrypt-custom {
            background-color: #c80a10;
            border-color: #c80a10;
            color: white;
            font-weight: 600;
        }
        .btn-encrypt-custom:hover {
            background-color: #a7080e; /* Darker shade for hover */
            border-color: #a7080e;
        }
        /* Custom color for Decryption Card */
        .card-header.bg-decrypt-custom {
            background-color: #008080; /* Teal */
            color: white;
        }
        .btn-decrypt-custom {
            background-color: #008080;
            border-color: #008080;
            color: white;
            font-weight: 600;
        }
        .btn-decrypt-custom:hover {
            background-color: #006666;
            border-color: #006666;
        }
        .form-control {
            border-radius: 6px; /* Rounded form controls */
            border: 1px solid #ced4da;
        }
        .form-control:focus {
            border-color: #80bdff;
            box-shadow: 0 0 0 0.2rem rgba(0,123,255,.25);
        }
        label {
            font-weight: 600; /* Semibold labels */
            margin-bottom: .5rem;
        }
        .result-box { /* Style taken from playfair.html and adapted */
            margin-top: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            background-color: #e9ecef;
            border-radius: 5px;
            white-space: pre-wrap; /* Preserve whitespace and newlines */
            word-wrap: break-word; /* Break long words */
        }
        textarea.form-control {
            min-height: 90px; /* Increased min-height */
        }
        .btn {
            padding: 0.5rem 1rem; /* Standard button padding */
            border-radius: 6px; /* Rounded buttons */
        }
        .home-link {
             margin-bottom: 20px;
             display: inline-block;
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="/" class="btn btn-outline-secondary home-link">&laquo; Back to Home</a>
        <h2 class="text-center page-title">CAESAR CIPHER</h2>

        <div class="card">
            <div class="card-header bg-encrypt-custom">ENCRYPTION</div>
            <div class="card-body">
                <form id="encryptForm">
                    <div class="form-group">
                        <label for="inputPlainText">Plain Text:</label>
                        <textarea class="form-control" id="inputPlainText" name="inputPlainText" rows="3" placeholder="Enter text to encrypt" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="inputKeyPlain">Key (shift value):</label>
                        <input type="number" class="form-control" id="inputKeyPlain" name="inputKeyPlain" placeholder="Enter shift key (e.g., 3)" required>
                    </div>
                    <button type="submit" class="btn btn-encrypt-custom btn-block">Encrypt</button>
                </form>
            </div>
        </div>

        <div class="card">
            <div class="card-header bg-decrypt-custom">DECRYPTION</div>
            <div class="card-body">
                <form id="decryptForm">
                    <div class="form-group">
                        <label for="inputCipherText">Cipher Text:</label>
                        <textarea class="form-control" id="inputCipherText" name="inputCipherText" rows="3" placeholder="Enter text to decrypt" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="inputKeyCipher">Key (shift value):</label>
                        <input type="number" class="form-control" id="inputKeyCipher" name="inputKeyCipher" placeholder="Enter shift key (e.g., 3)" required>
                    </div>
                    <button type="submit" class="btn btn-decrypt-custom btn-block">Decrypt</button>
                </form>
            </div>
        </div>

        <div id="resultDisplay" class="result-box" style="display:none;">
            <h4>Result:</h4>
            <p id="resultTextOutput"></p>
        </div>
    </div>

    <script>
        // Function to perform Caesar Cipher
        function caesarCipherProcess(text, shift, mode) {
            let result = '';
            // Ensure key is an integer
            shift = parseInt(shift);

            if (isNaN(shift)) { // Added check for invalid key
                return 'Error: Key must be a number.';
            }

            // Adjust shift for decryption: (26 - k) % 26 is equivalent to -k mod 26
            // Also handle negative keys correctly by ensuring shift is always positive for the algorithm.
            if (mode === 'decrypt') {
                shift = (26 - (shift % 26)) % 26;
            } else {
                shift = shift % 26;
            }

            // If shift became negative after modulo (e.g. -5 mod 26 = -5), make it positive (e.g. -5 + 26 = 21)
            if (shift < 0) {
                shift = shift + 26;
            }

            for (let i = 0; i < text.length; i++) {
                let char = text[i];
                // Check if it's an alphabet character (case-insensitive)
                if (char.match(/[a-z]/i)) {
                    let code = text.charCodeAt(i);
                    // Uppercase letters
                    if ((code >= 65) && (code <= 90)) {
                        char = String.fromCharCode(((code - 65 + shift) % 26) + 65);
                    // Lowercase letters
                    } else if ((code >= 97) && (code <= 122)) {
                        char = String.fromCharCode(((code - 97 + shift) % 26) + 97);
                    }
                }
                // Non-alphabetic characters are appended as is
                result += char;
            }
            return result;
        }

        const resultBox = document.getElementById('resultDisplay');
        const resultTextElem = document.getElementById('resultTextOutput');

        function displayResult(outputText) {
            resultTextElem.textContent = outputText; // Use textContent for security unless HTML is intended
            resultBox.style.display = 'block';
        }

        // Handle encryption form submission
        document.getElementById('encryptForm').addEventListener('submit', function(event) {
            event.preventDefault(); // Prevent default form submission (page reload)

            const plainText = document.getElementById('inputPlainText').value;
            const key = document.getElementById('inputKeyPlain').value;

            if (plainText.trim() && key.trim() !== '') {
                resultTextElem.textContent = 'Processing...'; // Show processing message
                resultBox.style.display = 'block';
                // Simulate a slight delay if needed, or directly process
                // setTimeout(() => { // Optional: for showing "Processing..." distinctly
                    const encryptedText = caesarCipherProcess(plainText, key, 'encrypt');
                    displayResult(encryptedText);
                // }, 100);
            } else {
                displayResult('Please provide both plain text and a key.');
            }
        });

        // Handle decryption form submission
        document.getElementById('decryptForm').addEventListener('submit', function(event) {
            event.preventDefault(); // Prevent default form submission

            const cipherText = document.getElementById('inputCipherText').value;
            const key = document.getElementById('inputKeyCipher').value;

            if (cipherText.trim() && key.trim() !== '') {
                resultTextElem.textContent = 'Processing...'; // Show processing message
                resultBox.style.display = 'block';
                // setTimeout(() => { // Optional: for showing "Processing..." distinctly
                    const decryptedText = caesarCipherProcess(cipherText, key, 'decrypt');
                    displayResult(decryptedText);
                // }, 100);
            } else {
                displayResult('Please provide both cipher text and a key.');
            }
        });
    </script>
</body>
</html>